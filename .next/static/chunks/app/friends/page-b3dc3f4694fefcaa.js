(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1872],{58:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});var l=t(2115);let a=l.forwardRef(function(e,s){let{title:t,titleId:a,...n}=e;return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":a},n),t?l.createElement("title",{id:a},t):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 7.5v3m0 0v3m0-3h3m-3 0h-3m-2.25-4.125a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0ZM3 19.235v-.11a6.375 6.375 0 0 1 12.75 0v.109A12.318 12.318 0 0 1 9.374 21c-2.331 0-4.512-.645-6.374-1.766Z"}))})},5647:(e,s,t)=>{Promise.resolve().then(t.bind(t,7767))},7767:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>u});var l=t(5155),a=t(2115),n=t(5695),r=t(3238),i=t(4236),c=t(8046),o=t(58);let d={friends:[],following:[],followers:[],requests_received:[],requests_sent:[],suggested:[]};function u(){let e=(0,n.useRouter)(),{authState:s,isLoading:t,user:u,requireAuth:x}=(0,i.A)(),[m,h]=(0,a.useState)("friends"),[p,f]=(0,a.useState)("received"),[g,b]=(0,a.useState)(""),[j,v]=(0,a.useState)(d),[N,w]=(0,a.useState)(!1),y=async()=>{if(null==u?void 0:u.id){w(!0);try{let l=await fetch("/api/friends?userId=".concat(u.id)),a=await l.json(),n=await fetch("/api/friends/requests?userId=".concat(u.id,"&type=sent")),r=await n.json(),i=await fetch("/api/friends/requests?userId=".concat(u.id,"&type=received")),c=await i.json();if(l.ok&&n.ok&&i.ok){var e,s,t;v(e=>({...e,friends:a.friends||[],requests_sent:r.requests||[],requests_received:c.requests||[]})),console.log("\uD83E\uDD1D Loaded ".concat((null==(e=a.friends)?void 0:e.length)||0," friends, ").concat((null==(s=r.requests)?void 0:s.length)||0," sent requests, ").concat((null==(t=c.requests)?void 0:t.length)||0," received requests"))}}catch(e){console.error("❌ Error loading friends data:",e)}finally{w(!1)}}};if((0,a.useEffect)(()=>{t||(null==s?void 0:s.isAuthenticated)||e.push("/signin")},[s,t,e]),(0,a.useEffect)(()=>{(null==u?void 0:u.id)&&!t&&y()},[null==u?void 0:u.id,t]),t)return(0,l.jsx)(r.default,{children:(0,l.jsxs)("div",{className:"p-4 text-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-600 mx-auto"}),(0,l.jsx)("p",{className:"mt-4 text-slate-600",children:"Loading friends..."})]})});if(!(null==s?void 0:s.isAuthenticated))return null;let D=()=>{switch(m){case"friends":return j.friends;case"following":return j.following;case"followers":return j.followers;case"requests":if("received"===p)return j.requests_received;if("sent"===p)return j.requests_sent;if("suggested"===p)return j.suggested;return[];default:return[]}},q=async e=>{if(null==u?void 0:u.id)try{console.log("✅ Accepting friend request: ".concat(e));let s=await fetch("/api/friends/requests",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({requestId:e,action:"accept",userId:u.id.toString()})});if(s.ok){let e=await s.json();console.log("✅ Friend request accepted:",e),await y()}else{let e=await s.json();console.error("❌ Accept request failed:",e),alert("Failed to accept request: ".concat(e.error))}}catch(e){console.error("❌ Accept request error:",e),alert("Failed to accept request. Please try again.")}},k=async e=>{if(null==u?void 0:u.id)try{console.log("❌ Declining friend request: ".concat(e));let s=await fetch("/api/friends/requests",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({requestId:e,action:"decline",userId:u.id.toString()})});if(s.ok){let e=await s.json();console.log("❌ Friend request declined:",e),await y()}else{let e=await s.json();console.error("❌ Decline request failed:",e),alert("Failed to decline request: ".concat(e.error))}}catch(e){console.error("❌ Decline request error:",e),alert("Failed to decline request. Please try again.")}};return(0,l.jsx)(r.default,{children:(0,l.jsxs)("div",{className:"p-4",children:[(0,l.jsxs)("div",{className:"mb-6 flex justify-between items-center",children:[(0,l.jsx)("div",{children:(0,l.jsx)("h1",{className:"text-2xl font-bold text-slate-800 mb-2",children:"\uD83E\uDD1D Friends"})}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(c.A,{className:"w-5 h-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400"}),(0,l.jsx)("input",{type:"text",placeholder:"Search",value:g,onChange:e=>b(e.target.value),className:"pl-10 pr-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent text-sm"})]})]}),(0,l.jsx)("div",{className:"flex space-x-1 mb-6 bg-slate-100 p-1 rounded-xl",children:[{key:"friends",label:"Friends",count:j.friends.length},{key:"following",label:"Following",count:j.following.length},{key:"followers",label:"Followers",count:j.followers.length},{key:"requests",label:"Requests",count:j.requests_received.length+j.requests_sent.length+j.suggested.length}].map(e=>(0,l.jsxs)("button",{onClick:()=>h(e.key),className:"flex-1 py-3 px-4 rounded-lg text-sm font-medium transition-all duration-200 ".concat(m===e.key?"bg-white text-cyan-600 shadow-soft":"text-slate-600 hover:text-slate-800"),children:[e.label," (",e.count,")"]},e.key))}),"requests"===m&&(0,l.jsx)("div",{className:"flex space-x-1 mb-6 bg-slate-100 p-1 rounded-xl",children:[{key:"received",label:"Received",count:j.requests_received.length},{key:"sent",label:"Sent",count:j.requests_sent.length},{key:"suggested",label:"Suggested",count:j.suggested.length}].map(e=>(0,l.jsxs)("button",{onClick:()=>f(e.key),className:"flex-1 py-3 px-4 rounded-lg text-sm font-medium transition-all duration-200 ".concat(p===e.key?"bg-white text-cyan-600 shadow-soft":"text-slate-600 hover:text-slate-800"),children:[e.label," (",e.count,")"]},e.key))}),(0,l.jsx)("div",{className:"space-y-4",children:D().length>0?D().map(s=>(s=>{let t="fromUser"in s?"requests"===m&&"received"===p?s.fromUser:s.toUser:s,a="fromUser"in s?s.id:null,n=["from-cyan-500 to-teal-600","from-purple-500 to-pink-600","from-green-500 to-blue-600","from-orange-500 to-red-600","from-blue-500 to-purple-600","from-yellow-500 to-orange-600"],r=n[parseInt(t.id)%n.length];return(0,l.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden shadow-sm hover:shadow-md transition-all duration-200 cursor-pointer",onClick:()=>{var s;return s=t.id,void e.push("/user/".concat(s))},children:[(0,l.jsx)("div",{className:"bg-gradient-to-r ".concat(r," p-4 text-white relative"),children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)("div",{className:"w-12 h-12 bg-white/20 rounded-full flex items-center justify-center",children:t.avatar_url||t.avatar?(0,l.jsx)("img",{src:t.avatar||t.avatar_url||"https://ui-avatars.com/api/?name=".concat(encodeURIComponent(t.name),"&background=64748b&color=fff"),alt:t.name,className:"w-10 h-10 rounded-full object-cover"}):(0,l.jsx)("span",{className:"text-lg font-semibold",children:t.name.split(" ").map(e=>e[0]).join("")})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"font-semibold text-lg",children:t.name}),(0,l.jsx)("p",{className:"text-white/80 text-sm",children:t.bio})]})]}),(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsx)("span",{className:"text-xs text-white/80",children:"Trust Score:"}),(0,l.jsx)("div",{className:"text-lg font-bold",children:t.trust_score})]})]})}),(0,l.jsxs)("div",{className:"p-4",children:[(0,l.jsxs)("div",{className:"space-y-2 text-sm text-slate-600",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("span",{className:"font-medium",children:["friends"===m&&"Mutual Connection","following"===m&&"You Follow","followers"===m&&"Follows You","requests"===m&&"received"===p&&"Wants to be friends","requests"===m&&"sent"===p&&"Friend request sent","requests"===m&&"suggested"===p&&"Suggested Connection"]}),t.location&&(0,l.jsxs)("span",{className:"text-slate-500",children:["• ",t.location]})]}),t.mutual_friends&&t.mutual_friends>0&&(0,l.jsxs)("div",{children:[(0,l.jsxs)("span",{className:"font-medium",children:[t.mutual_friends," mutual friends: "]}),(0,l.jsxs)("span",{className:"text-slate-500",children:["Sarah Kim, Mike Chen, Alex Rivera",t.mutual_friends>3&&" and ".concat(t.mutual_friends-3," others")]})]}),"following"===m&&(0,l.jsx)("div",{className:"text-slate-500",children:"Private content locked - follow each other to unlock"}),"requests"===m&&"received"===p&&(0,l.jsx)("div",{className:"text-slate-500",children:t.mutual_friends&&t.mutual_friends>0?"Also runs marathons • Lives in Denver area":"Plays at venues you follow • Local music scene"})]}),"requests"===m&&"received"===p&&a&&(0,l.jsxs)("div",{className:"flex space-x-3 mt-4",onClick:e=>e.stopPropagation(),children:[(0,l.jsx)("button",{onClick:()=>q(a),className:"flex-1 bg-green-50 hover:bg-green-100 text-green-600 py-2 px-4 rounded-lg text-sm font-medium transition-colors",children:"Accept Request"}),(0,l.jsx)("button",{onClick:()=>k(a),className:"flex-1 bg-red-50 hover:bg-red-100 text-red-600 py-2 px-4 rounded-lg text-sm font-medium transition-colors",children:"Decline"})]})]})]},t.id)})(s)):(0,l.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:["friends"===m&&(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"text-center py-8",children:[(0,l.jsx)(o.A,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),(0,l.jsx)("h3",{className:"text-lg font-medium text-slate-800 mb-2",children:"No friends yet"}),(0,l.jsx)("p",{className:"text-slate-500 mb-6",children:"Build meaningful connections in your community. Here's how friendships work:"})]}),(0,l.jsxs)("div",{className:"grid gap-4",children:[(0,l.jsxs)("div",{className:"p-4 rounded-xl bg-green-50 border border-green-200",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,l.jsx)("span",{className:"text-2xl",children:"\uD83E\uDD1D"}),(0,l.jsx)("h4",{className:"font-semibold text-slate-800",children:"Mutual Friends"})]}),(0,l.jsx)("p",{className:"text-sm text-slate-600 ml-11",children:"When you both accept each other's friend requests, you become mutual friends with full access"})]}),(0,l.jsxs)("div",{className:"p-4 rounded-xl bg-blue-50 border border-blue-200",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,l.jsx)("span",{className:"text-2xl",children:"\uD83D\uDC65"}),(0,l.jsx)("h4",{className:"font-semibold text-slate-800",children:"Mutual Connections"})]}),(0,l.jsx)("p",{className:"text-sm text-slate-600 ml-11",children:"See who you both know, making it easier to make posts about each other and include in events"})]}),(0,l.jsxs)("div",{className:"p-4 rounded-xl bg-purple-50 border border-purple-200",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,l.jsx)("span",{className:"text-2xl",children:"\uD83C\uDF89"}),(0,l.jsx)("h4",{className:"font-semibold text-slate-800",children:"Event Access"})]}),(0,l.jsx)("p",{className:"text-sm text-slate-600 ml-11",children:'Friends can include each other in private events and see "public to friends" content'})]})]}),(0,l.jsx)("div",{className:"text-center mt-6",children:(0,l.jsx)("button",{onClick:()=>e.push("/search"),className:"px-6 py-3 bg-cyan-500 text-white rounded-lg hover:bg-cyan-600 transition-colors",children:"\uD83D\uDD0D Find People to Connect With"})})]}),"following"===m&&(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"text-center py-8",children:[(0,l.jsx)(o.A,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),(0,l.jsx)("h3",{className:"text-lg font-medium text-slate-800 mb-2",children:"Not following anyone"}),(0,l.jsx)("p",{className:"text-slate-500 mb-6",children:"Following lets you see someone's public content. Here's what you can do:"})]}),(0,l.jsxs)("div",{className:"grid gap-4",children:[(0,l.jsxs)("div",{className:"p-4 rounded-xl bg-blue-50 border border-blue-200",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,l.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCF1"}),(0,l.jsx)("h4",{className:"font-semibold text-slate-800",children:"Public Content"})]}),(0,l.jsx)("p",{className:"text-sm text-slate-600 ml-11",children:"See their public posts, events, and activity updates in your feed"})]}),(0,l.jsxs)("div",{className:"p-4 rounded-xl bg-orange-50 border border-orange-200",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,l.jsx)("span",{className:"text-2xl",children:"\uD83D\uDD04"}),(0,l.jsx)("h4",{className:"font-semibold text-slate-800",children:"One-Way Connection"})]}),(0,l.jsx)("p",{className:"text-sm text-slate-600 ml-11",children:"You follow them, but they don't need to follow you back. Send a friend request for mutual access"})]})]}),(0,l.jsx)("div",{className:"text-center mt-6",children:(0,l.jsx)("button",{onClick:()=>e.push("/discover"),className:"px-6 py-3 bg-cyan-500 text-white rounded-lg hover:bg-cyan-600 transition-colors",children:"\uD83C\uDF1F Discover Interesting People"})})]}),"followers"===m&&(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"text-center py-8",children:[(0,l.jsx)(o.A,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),(0,l.jsx)("h3",{className:"text-lg font-medium text-slate-800 mb-2",children:"No followers yet"}),(0,l.jsx)("p",{className:"text-slate-500 mb-6",children:"Build an audience by sharing great content. Here's how followers work:"})]}),(0,l.jsxs)("div",{className:"grid gap-4",children:[(0,l.jsxs)("div",{className:"p-4 rounded-xl bg-green-50 border border-green-200",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,l.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCE2"}),(0,l.jsx)("h4",{className:"font-semibold text-slate-800",children:"Content Reach"})]}),(0,l.jsx)("p",{className:"text-sm text-slate-600 ml-11",children:'Your public posts and "public to followers" events will reach your followers'})]}),(0,l.jsxs)("div",{className:"p-4 rounded-xl bg-yellow-50 border border-yellow-200",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,l.jsx)("span",{className:"text-2xl",children:"\uD83E\uDD1D"}),(0,l.jsx)("h4",{className:"font-semibold text-slate-800",children:"Follow Back"})]}),(0,l.jsx)("p",{className:"text-sm text-slate-600 ml-11",children:"Follow your followers back to become mutual friends and unlock full access"})]})]}),(0,l.jsx)("div",{className:"text-center mt-6",children:(0,l.jsx)("button",{onClick:()=>e.push("/create-post"),className:"px-6 py-3 bg-cyan-500 text-white rounded-lg hover:bg-cyan-600 transition-colors",children:"\uD83D\uDCDD Create Great Content"})})]}),"requests"===m&&(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"text-center py-8",children:[(0,l.jsx)(o.A,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),(0,l.jsxs)("h3",{className:"text-lg font-medium text-slate-800 mb-2",children:["received"===p&&"No friend requests","sent"===p&&"No sent requests","suggested"===p&&"No suggestions available"]}),(0,l.jsxs)("p",{className:"text-slate-500 mb-6",children:["received"===p&&"Friend requests from others will appear here","sent"===p&&"Friend requests you send will appear here","suggested"===p&&"We suggest people based on mutual connections"]})]}),"suggested"===p&&(0,l.jsxs)("div",{className:"grid gap-4",children:[(0,l.jsxs)("div",{className:"p-4 rounded-xl bg-purple-50 border border-purple-200",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,l.jsx)("span",{className:"text-2xl",children:"\uD83C\uDFAF"}),(0,l.jsx)("h4",{className:"font-semibold text-slate-800",children:"Smart Suggestions"})]}),(0,l.jsx)("p",{className:"text-sm text-slate-600 ml-11",children:"We suggest people based on mutual friends, similar interests, and shared community connections"})]}),(0,l.jsxs)("div",{className:"p-4 rounded-xl bg-blue-50 border border-blue-200",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,l.jsx)("span",{className:"text-2xl",children:"\uD83C\uDF10"}),(0,l.jsx)("h4",{className:"font-semibold text-slate-800",children:"Community Connections"})]}),(0,l.jsx)("p",{className:"text-sm text-slate-600 ml-11",children:"Find people who attend similar events, share mutual friends, or live in your area"})]})]}),(0,l.jsx)("div",{className:"text-center mt-6",children:(0,l.jsx)("button",{onClick:()=>e.push("/search"),className:"px-6 py-3 bg-cyan-500 text-white rounded-lg hover:bg-cyan-600 transition-colors",children:"\uD83D\uDD0D Search for People"})})]})]})})]})})}}},e=>{e.O(0,[4684,4236,3238,8441,5964,7358],()=>e(e.s=5647)),_N_E=e.O()}]);