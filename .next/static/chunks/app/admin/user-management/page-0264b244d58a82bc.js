(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[408],{1992:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>i});var a=t(5155),l=t(2115),r=t(5695),d=t(3238),n=t(4236);function i(){let e=(0,r.useRouter)(),{authState:s,isLoading:t}=(0,n.A)(),[i,c]=(0,l.useState)([]),[o,x]=(0,l.useState)(null),[m,u]=(0,l.useState)(!1),[h,b]=(0,l.useState)(""),[p,g]=(0,l.useState)(null),[j,f]=(0,l.useState)([]),[N,w]=(0,l.useState)(!1),v=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";f(t=>['<div style="color: '.concat("error"===s?"red":"success"===s?"green":"black",'; margin-bottom: 5px;">[').concat(new Date().toLocaleTimeString(),"] ").concat(e,"</div>"),...t].slice(0,100))},y=(0,l.useCallback)(async()=>{u(!0);try{let e=await fetch("/api/admin/stats"),s=await e.json();s.success?(x(s.stats),v("Stats loaded successfully","success")):v("Failed to load stats: "+s.error,"error")}catch(e){v("Error loading stats: "+e.message,"error")}u(!1)},[]),D=(0,l.useCallback)(async()=>{u(!0);try{let e=await fetch("/api/admin/users"),s=await e.json();s.success?(c(s.users),v("Loaded ".concat(s.count," users"),"success")):v("Failed to load users: "+s.error,"error")}catch(e){v("Error loading users: "+e.message,"error")}u(!1)},[]),E=async()=>{if(!h)return void v("Please enter a username","error");u(!0);try{let e=await fetch("/api/admin/users/username/".concat(encodeURIComponent(h))),s=await e.json();s.success?(g(s.user),v("Found user: ID ".concat(s.user.id,", Email: ").concat(s.user.email,", Created: ").concat(new Date(s.user.created_at).toLocaleString()),"success")):(g(null),v("User not found","error"))}catch(e){v("Error finding user: "+e.message,"error")}u(!1)},L=async(e,s)=>{if(confirm("Are you sure you want to delete user: ".concat(s,"?"))){u(!0);try{let t=await fetch("/api/admin/users/".concat(e),{method:"DELETE"}),a=await t.json();a.success?(v("User deleted successfully: ".concat(s),"success"),D(),y()):v("Failed to delete user: "+a.error,"error")}catch(e){v("Error deleting user: "+e.message,"error")}u(!1)}},C=async()=>{if(!h)return void v("Please enter a username","error");if(confirm("Are you sure you want to delete user: ".concat(h,"?"))){u(!0);try{let e=await fetch("/api/admin/users/username/".concat(encodeURIComponent(h)),{method:"DELETE"}),s=await e.json();s.success?(v("User deleted successfully: ".concat(h),"success"),b(""),g(null),D(),y()):v("Failed to delete user: "+s.error,"error")}catch(e){v("Error deleting user: "+e.message,"error")}u(!1)}},A=async()=>{if("DELETE ALL USERS"!==prompt("This will delete ALL users! Type &quot;DELETE ALL USERS&quot; to confirm:"))return void v("Delete all users cancelled","info");u(!0);try{let e=await fetch("/api/admin/users/ALL/confirm-delete-all",{method:"DELETE"}),s=await e.json();s.success?(v("All users deleted. Count: ".concat(s.deletedCount),"success"),D(),y()):v("Failed to delete all users: "+s.error,"error")}catch(e){v("Error deleting all users: "+e.message,"error")}u(!1)},U=async()=>{if("NUCLEAR RESET"!==prompt("⚠️ NUCLEAR RESET: This will delete ALL users AND reset ID counter!\nType &quot;NUCLEAR RESET&quot; to confirm:")||!confirm("Are you absolutely sure? This action cannot be undone!"))return void v("Nuclear reset cancelled","info");u(!0);try{let e=await fetch("/api/admin/nuclear-reset",{method:"DELETE"}),s=await e.json();s.success?(v("☢️ NUCLEAR RESET COMPLETE: All users deleted and ID sequence reset to 1","success"),D(),y()):v("Nuclear reset failed: "+s.error,"error")}catch(e){v("Error during nuclear reset: "+e.message,"error")}u(!1)};return((0,l.useEffect)(()=>{if(!t){var a;if(!s.isAuthenticated)return void e.push("/signin");w(!0),v("Access granted for ".concat((null==(a=s.user)?void 0:a.email)||"unknown user"),"success"),y(),D()}},[t,s.isAuthenticated,s.user,e,y,D]),t)?(0,a.jsx)(d.default,{children:(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-soft p-8 border border-slate-200 text-center max-w-md",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"})}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-slate-800 mb-2",children:"\uD83D\uDD10 User Administration"}),(0,a.jsx)("p",{className:"text-slate-600",children:"Checking authentication..."})]})})}):N?(0,a.jsx)(d.default,{children:(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto p-6",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-slate-800 mb-2",children:"\uD83D\uDD10 User Administration"}),(0,a.jsx)("p",{className:"text-slate-600",children:"Manage user accounts and system settings"})]}),(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-5 h-5 bg-blue-500 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white text-xs",children:"ℹ"})}),(0,a.jsx)("p",{className:"text-blue-800 font-medium",children:"Admin Access Active"})]}),(0,a.jsx)("p",{className:"text-blue-700 text-sm mt-1",children:"You have administrative privileges to manage user accounts and system data."})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,a.jsx)("div",{className:"bg-white rounded-xl shadow-soft p-6 border border-slate-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-slate-600 text-sm font-medium",children:"Total Users"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-slate-800 mt-1",children:o?o.totalUsers||"0":(0,a.jsx)("span",{className:"text-slate-400",children:"Loading..."})})]}),(0,a.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-blue-600 text-xl",children:"\uD83D\uDC65"})})]})}),(0,a.jsx)("div",{className:"bg-white rounded-xl shadow-soft p-6 border border-slate-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-slate-600 text-sm font-medium",children:"Recent Users (7 days)"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-slate-800 mt-1",children:o?o.recentUsers||"0":(0,a.jsx)("span",{className:"text-slate-400",children:"Loading..."})})]}),(0,a.jsx)("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-green-600 text-xl",children:"\uD83D\uDCC8"})})]})}),(0,a.jsx)("div",{className:"bg-white rounded-xl shadow-soft p-6 border border-slate-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-slate-600 text-sm font-medium",children:"Today's Users"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-slate-800 mt-1",children:o?o.todayUsers||"0":(0,a.jsx)("span",{className:"text-slate-400",children:"Loading..."})})]}),(0,a.jsx)("div",{className:"w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-orange-600 text-xl",children:"⭐"})})]})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-soft p-6 border border-slate-200 mb-8",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-slate-800 mb-6",children:"User Management Controls"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[(0,a.jsx)("button",{onClick:D,disabled:m,className:"flex items-center justify-center px-4 py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-slate-300 text-white rounded-lg font-medium transition-colors duration-200",children:m?"⏳ Loading...":"\uD83D\uDC65 Load All Users"}),(0,a.jsx)("button",{onClick:y,disabled:m,className:"flex items-center justify-center px-4 py-3 bg-green-600 hover:bg-green-700 disabled:bg-slate-300 text-white rounded-lg font-medium transition-colors duration-200",children:m?"⏳ Loading...":"\uD83D\uDCCA Refresh Stats"}),(0,a.jsx)("button",{onClick:()=>{c([]),x(null),g(null),f([]),v("Cache cleared - all data reset","success")},disabled:m,className:"flex items-center justify-center px-4 py-3 bg-purple-600 hover:bg-purple-700 disabled:bg-slate-300 text-white rounded-lg font-medium transition-colors duration-200",children:"\uD83E\uDDF9 Clear Cache"})]}),(0,a.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4 mb-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-slate-800 mb-3",children:"\uD83D\uDD0D Find User"}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,a.jsx)("input",{type:"text",value:h,onChange:e=>b(e.target.value),placeholder:"Enter username to search...",className:"flex-1 px-4 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,a.jsx)("button",{onClick:E,disabled:m,className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-slate-300 text-white rounded-lg font-medium transition-colors duration-200",children:"Find User"}),(0,a.jsx)("button",{onClick:C,disabled:m,className:"px-6 py-2 bg-red-600 hover:bg-red-700 disabled:bg-slate-300 text-white rounded-lg font-medium transition-colors duration-200",children:"Delete User"})]})]}),(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-red-800 mb-3",children:"⚠️ Danger Zone"}),(0,a.jsx)("p",{className:"text-red-700 text-sm mb-4",children:"These actions are irreversible. Use with extreme caution."}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,a.jsx)("button",{onClick:A,disabled:m,className:"px-6 py-2 bg-red-600 hover:bg-red-700 disabled:bg-slate-300 text-white rounded-lg font-medium transition-colors duration-200",children:"\uD83D\uDDD1️ Delete ALL Users"}),(0,a.jsx)("button",{onClick:U,disabled:m,className:"px-6 py-2 bg-red-900 hover:bg-red-800 disabled:bg-slate-300 text-white rounded-lg font-medium transition-colors duration-200",children:"☢️ Nuclear Reset"})]})]})]}),p&&(0,a.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-xl p-6 mb-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-green-800",children:"✅ User Found"}),(0,a.jsxs)("span",{className:"text-sm text-green-600 bg-green-100 px-3 py-1 rounded-full",children:["ID: ",p.id]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("p",{className:"text-sm",children:[(0,a.jsx)("span",{className:"font-medium text-slate-700",children:"Email:"})," ",(0,a.jsx)("span",{className:"text-slate-600",children:p.email})]}),(0,a.jsxs)("p",{className:"text-sm",children:[(0,a.jsx)("span",{className:"font-medium text-slate-700",children:"Username:"})," ",(0,a.jsx)("span",{className:"text-slate-600",children:p.username||"N/A"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("p",{className:"text-sm",children:[(0,a.jsx)("span",{className:"font-medium text-slate-700",children:"Phone:"})," ",(0,a.jsx)("span",{className:"text-slate-600",children:p.phone||"N/A"})]}),(0,a.jsxs)("p",{className:"text-sm",children:[(0,a.jsx)("span",{className:"font-medium text-slate-700",children:"Created:"})," ",(0,a.jsx)("span",{className:"text-slate-600",children:new Date(p.created_at).toLocaleString()})]})]})]}),(0,a.jsx)("button",{onClick:()=>L(p.id,p.email),disabled:m,className:"px-4 py-2 bg-red-600 hover:bg-red-700 disabled:bg-slate-300 text-white rounded-lg font-medium transition-colors duration-200",children:"\uD83D\uDDD1️ Delete This User"})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-soft border border-slate-200 mb-8",children:[(0,a.jsxs)("div",{className:"p-6 border-b border-slate-200",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-slate-800",children:"\uD83D\uDC65 Users List"}),(0,a.jsx)("button",{onClick:D,disabled:m,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-slate-300 text-white rounded-lg font-medium transition-colors duration-200",children:m?"⏳ Loading...":"\uD83D\uDD04 Reload Users"})]}),i.length>0&&(0,a.jsxs)("p",{className:"text-sm text-slate-600 mt-2",children:["Showing ",i.length," user",1!==i.length?"s":""]})]}),0===i.length?(0,a.jsxs)("div",{className:"p-8 text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)("span",{className:"text-slate-400 text-2xl",children:"\uD83D\uDC65"})}),(0,a.jsx)("p",{className:"text-slate-600 mb-4",children:"No users found"}),(0,a.jsx)("button",{onClick:D,disabled:m,className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-slate-300 text-white rounded-lg font-medium transition-colors duration-200",children:"Load All Users"})]}):(0,a.jsx)("div",{className:"overflow-x-auto max-h-96 overflow-y-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-slate-50 sticky top-0",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"ID"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Email"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Username"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Phone"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Created"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-slate-200",children:i.map((e,s)=>(0,a.jsxs)("tr",{className:"hover:bg-slate-50 transition-colors duration-150 ".concat(s%2==0?"bg-white":"bg-slate-25"),children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-mono text-slate-900",children:e.id}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-900",children:e.email}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-900",children:e.username||(0,a.jsx)("span",{className:"text-slate-400",children:"N/A"})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-900",children:e.phone||(0,a.jsx)("span",{className:"text-slate-400",children:"N/A"})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-900",children:new Date(e.created_at).toLocaleDateString()}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(0,a.jsx)("button",{onClick:()=>L(e.id,e.email),disabled:m,className:"px-3 py-1 bg-red-600 hover:bg-red-700 disabled:bg-slate-300 text-white rounded font-medium transition-colors duration-200 text-xs",children:"Delete"})})]},e.id))})]})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-soft border border-slate-200",children:[(0,a.jsxs)("div",{className:"p-6 border-b border-slate-200",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-slate-800",children:"\uD83D\uDCCB Activity Log"}),(0,a.jsx)("p",{className:"text-sm text-slate-600 mt-1",children:"Real-time system activity and responses"})]}),(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)("div",{className:"bg-slate-900 rounded-lg p-4 font-mono text-sm max-h-64 overflow-y-auto",children:0===j.length?(0,a.jsx)("p",{className:"text-slate-400",children:"No activity yet. Perform actions to see logs here."}):(0,a.jsx)("div",{className:"text-green-400 space-y-1",dangerouslySetInnerHTML:{__html:j.join("")}})})})]})]})})}):(0,a.jsx)(d.default,{children:(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-soft p-8 border border-slate-200 text-center max-w-md",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)("span",{className:"text-red-600 text-2xl",children:"\uD83D\uDD10"})}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-slate-800 mb-2",children:"Access Denied"}),(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:[(0,a.jsx)("p",{className:"text-red-800 font-medium mb-2",children:"⚠️ Admin Access Required"}),(0,a.jsx)("p",{className:"text-red-700 text-sm",children:"You don't have permission to access this page."}),(0,a.jsx)("p",{className:"text-red-600 text-sm mt-2",children:"Redirecting to home page in 3 seconds..."})]}),j.length>0&&(0,a.jsx)("div",{className:"bg-slate-100 rounded-lg p-4 max-h-32 overflow-y-auto",children:(0,a.jsx)("div",{className:"text-sm text-left",dangerouslySetInnerHTML:{__html:j.join("")}})})]})})})}},4898:(e,s,t)=>{Promise.resolve().then(t.bind(t,1992))}},e=>{e.O(0,[4684,4236,3238,8441,5964,7358],()=>e(e.s=4898)),_N_E=e.O()}]);