(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8733],{3910:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var r=s(5155),a=s(2115),l=s(3238);function d(){let[e,t]=(0,a.useState)([]),[s,d]=(0,a.useState)(!1),[n,i]=(0,a.useState)(!1),[c,o]=(0,a.useState)(null),[x,u]=(0,a.useState)(null),[m,h]=(0,a.useState)(null),[p,g]=(0,a.useState)(!1),[b,y]=(0,a.useState)(null),[j,f]=(0,a.useState)(null),[N,w]=(0,a.useState)(null),v=async()=>{i(!0),o(null);try{let e=await fetch("/api/admin/users");if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let s=await e.json();t(s.users||[]),y(s.databaseStatus),f(s.issue),w(s.note)}catch(e){console.error("Failed to fetch users:",e),o("Failed to load users. Please try again.")}finally{i(!1)}};(0,a.useEffect)(()=>{v()},[]);let k=async e=>{if(confirm("Are you sure you want to delete user ".concat(e,"?"))){h(Number(e)),o(null);try{let s=await fetch("/api/admin/users/".concat(e),{method:"DELETE"});if(!s.ok)throw Error("HTTP error! status: ".concat(s.status));let r=await s.json();if(r.success)t(t=>t.filter(t=>t.id!==e)),u("Successfully deleted user ".concat(e)),setTimeout(()=>u(null),3e3);else throw Error(r.error||"Failed to delete user")}catch(t){console.error("Failed to delete user:",t),o("Failed to delete user ".concat(e,". Please try again.")),setTimeout(()=>o(null),5e3)}finally{h(null)}}},S=async()=>{let s=e.filter(e=>e.email.includes("test")||e.username.includes("test"));if(0===s.length){o("No test users found to delete."),setTimeout(()=>o(null),3e3);return}if(confirm("Are you sure you want to delete ".concat(s.length," test users?"))){g(!0),o(null);try{let e=await fetch("/api/admin/users",{method:"DELETE"});if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let s=await e.json();if(s.success)t(e=>e.filter(e=>!e.email.includes("test")&&!e.username.includes("test"))),u("Successfully deleted ".concat(s.deleted," test users")),setTimeout(()=>u(null),3e3);else throw Error(s.error||"Failed to delete test users")}catch(e){console.error("Failed to delete test users:",e),o("Failed to delete test users. Please try again."),setTimeout(()=>o(null),5e3)}finally{g(!1)}}};return s&&e.filter(e=>e.email.includes("test")||e.username.includes("test")),(0,r.jsx)(l.default,{children:(0,r.jsxs)("div",{className:"max-w-6xl mx-auto p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"User Management"}),(0,r.jsx)("div",{className:"flex space-x-2",children:(0,r.jsx)("button",{onClick:v,disabled:n,className:"px-4 py-2 bg-cyan-500 text-white rounded-lg hover:bg-cyan-600 disabled:opacity-50",children:n?"Loading...":"Refresh"})})]}),x&&(0,r.jsx)("div",{className:"mb-4 p-4 bg-green-100 border border-green-400 rounded-lg",children:(0,r.jsx)("p",{className:"text-green-800",children:x})}),c&&(0,r.jsx)("div",{className:"mb-4 p-4 bg-red-100 border border-red-400 rounded-lg",children:(0,r.jsx)("p",{className:"text-red-800",children:c})}),b&&(0,r.jsxs)("div",{className:"mb-6 p-4 border rounded-lg",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"Database Status"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsx)("div",{className:"p-3 rounded ".concat(b.connected?"bg-green-100":"bg-red-100"),children:(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Connection:"})," ",b.connected?"✅ Connected":"❌ Disconnected"]})}),(0,r.jsx)("div",{className:"p-3 rounded bg-blue-100",children:(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"User Count:"})," ",b.userCount]})}),(0,r.jsx)("div",{className:"p-3 rounded ".concat(b.adminRoutesWorking?"bg-green-100":"bg-yellow-100"),children:(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Admin Routes:"})," ",b.adminRoutesWorking?"✅ Working":"❌ Not Working"]})})]}),b.error&&(0,r.jsxs)("div",{className:"mt-2 p-2 bg-red-100 border border-red-400 rounded text-sm",children:[(0,r.jsx)("strong",{children:"Error:"})," ",b.error]})]}),N&&(0,r.jsx)("div",{className:"mb-4 p-3 bg-blue-100 border border-blue-400 rounded-lg",children:(0,r.jsx)("p",{className:"text-blue-800 text-sm",children:N})}),j&&(0,r.jsxs)("div",{className:"mb-6 p-4 bg-yellow-50 border border-yellow-300 rounded-lg",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-2 text-yellow-800",children:"Current Issue"}),(0,r.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Problem:"})," ",j.problem]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Solution:"})," ",j.solution]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Status:"})," ",j.currentStatus]})]})]}),N&&(0,r.jsx)("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-300 rounded-lg",children:(0,r.jsx)("p",{className:"text-sm text-blue-800",children:N})}),c&&(0,r.jsx)("div",{className:"mb-6 p-4 bg-red-100 border border-red-400 text-red-700 rounded",children:c}),x&&(0,r.jsx)("div",{className:"mb-6 p-4 bg-green-100 border border-green-400 text-green-700 rounded",children:x}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,r.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,r.jsxs)("h2",{className:"text-lg font-semibold",children:["Users (",e.length,")"]})}),0===e.length?(0,r.jsx)("div",{className:"p-6 text-center text-gray-500",children:n?"Loading users...":"No users found"}):(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Username"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trust Score"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Friends"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Reviews"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.id}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.name}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:["@",e.username]}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.email}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.trustScore}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.friendsCount}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.reviewsCount}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat("active"===e.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.status})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.createdAt).toLocaleDateString()}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,r.jsx)("button",{onClick:()=>k(e.id),disabled:m===e.id,className:"text-red-600 hover:text-red-900 disabled:opacity-50",children:m===e.id?"Deleting...":"Delete"})})]},e.id))})]})})]}),s&&(0,r.jsxs)("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Test User Management"}),(0,r.jsx)("div",{className:"flex space-x-4",children:(0,r.jsx)("button",{onClick:S,disabled:p,className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 disabled:opacity-50",children:p?"Deleting...":"Delete All Test Users"})})]})]})})}},4727:(e,t,s)=>{Promise.resolve().then(s.bind(s,3910))}},e=>{e.O(0,[4684,4236,3238,8441,5964,7358],()=>e(e.s=4727)),_N_E=e.O()}]);